language: java

before_install:
  - wget https://archive.apache.org/dist/maven/maven-3/3.3.9/binaries/apache-maven-3.3.9-bin.zip
  - unzip -qq apache-maven-3.3.9-bin.zip
  - export M2_HOME=$PWD/apache-maven-3.3.9
  - export PATH=$M2_HOME/bin:$PATH
  - "git clone -b travis `git config --get remote.origin.url` target/travis"

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start

jdk:
- oraclejdk8

notifications:
  email: false

install:
  - true

script:
  - git describe
  - echo "Building branch <${TRAVIS_BRANCH}>"
  - "[ ${TRAVIS_BRANCH} = 'develop' ] && mvn clean deploy --settings target/travis/settings.xml -B -U --show-version || mvn clean verify --settings target/travis/settings.xml -B -U --show-version"

before_cache:
  - rm -rf $HOME/.m2/repositor/com/cedarsoft
cache:
  directories:
  - $HOME/.m2
